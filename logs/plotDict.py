import os
import numpy as np 
from  mpl_toolkits import mplot3d
import matplotlib.pyplot as plt 
import pdb

## Data
# data = {'epoch': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49], 'lr': [0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.0002, 0.0002, 0.0002, 0.0002, 0.0002, 0.0002, 0.0002, 4e-05, 4e-05, 4e-05, 4e-05, 4e-05, 4e-05], 'train_time': [3231.011605501175, 3212.2327165603638, 3098.963080406189, 3113.2424290180206, 3097.511477470398, 3102.1319739818573, 3106.160697698593, 3133.864295244217, 3148.2198112010956, 3084.787622690201, 3131.3359763622284, 3136.9216475486755, 3212.5427029132843, 3253.686944246292, 3215.8309473991394, 3184.0877318382263, 3169.7076301574707, 3122.19557762146, 3134.0340905189514, 3289.7678515911102, 3196.6253111362457, 3152.469057559967, 3216.2557253837585, 3171.214831829071, 3206.9634795188904, 3144.5362317562103, 3160.253875017166, 3145.77645778656, 3124.250913143158, 3163.3401374816895, 3121.774619102478, 3157.7640895843506, 3057.441219806671, 3106.672828912735, 3192.8366389274597, 3280.5031275749207, 3141.6471042633057, 3143.9048228263855, 3203.1782369613647, 3155.439409017563, 3193.3113272190094, 3087.0590510368347, 3055.7183768749237, 3118.5011184215546, 3216.738425254822, 3214.8327326774597, 3113.885182619095, 3067.4214160442352, 3171.6952221393585, 3178.9455082416534], 'train_loss': [0.3248074316008467, 0.051114172192284285, 0.04903264488944387, 0.04360370395413369, 0.04067069901854655, 0.03963337897655579, 0.03863807711541855, 0.037874783616972864, 0.03734050955733767, 0.036277181815611986, 0.03540549761679386, 0.03461300086936974, 0.034120315458797144, 0.033765180106915614, 0.033260136849511394, 0.03294749190793895, 0.03249040153930472, 0.03315275256109493, 0.03188874657392196, 0.031487802278525295, 0.031159337712343842, 0.030956324797005726, 0.030744123080299574, 0.030474770621697216, 0.030311812829062677, 0.03011082765280917, 0.029941989247060947, 0.02978810358914164, 0.029708605018140054, 0.02950740442640008, 0.029372885319998245, 0.029162556348852176, 0.02913577505882245, 0.028992336488727736, 0.028939611944513246, 0.028852819414799724, 0.02870728382233942, 0.02716444727361444, 0.026829635083177622, 0.026639742664958405, 0.026487365407667943, 0.026354169158051128, 0.026241598046095767, 0.026138106358666875, 0.02575356851658895, 0.025645204729669233, 0.025593932752544745, 0.025602524509887255, 0.02551390433286078, 0.02550694550370406], 'valid_time': [504.6696820259094, 496.53981590270996, 486.91880774497986, 484.17242097854614, 483.6728150844574, 480.39476895332336, 489.07954621315, 498.13478112220764, 484.08902764320374, 478.51645851135254, 483.7754843235016, 489.86595463752747, 502.7616813182831, 502.203143119812, 496.09410333633423, 491.87635135650635, 494.8828523159027, 486.2730927467346, 500.3970277309418, 513.9691388607025, 491.65997886657715, 484.79531598091125, 491.8948013782501, 499.5493104457855, 503.70802187919617, 489.64907217025757, 485.1460027694702, 485.8050696849823, 491.09396958351135, 488.35275983810425, 487.18832063674927, 478.4782154560089, 478.74397373199463, 486.08106660842896, 501.0634026527405, 497.2377018928528, 485.008837223053, 507.71214962005615, 493.7962543964386, 490.2905218601227, 490.0200402736664, 468.789311170578, 474.9931449890137, 494.95707082748413, 501.96608686447144, 491.5805642604828, 477.14450120925903, 490.98901653289795, 476.7746515274048, 499.0982406139374], 'valid_loss': [0.05178090114535007, 0.04726424758059147, 0.045850825182951666, 0.0407742409675418, 0.040853868743996824, 0.03931548722289642, 0.03900759087965025, 0.039390534291918355, 0.03909193825226323, 0.03556967426740084, 0.03462353786055701, 0.033722157719656136, 0.03335002284953339, 0.034249713620153215, 0.03311546690945943, 0.03314308068344394, 0.03248230188938305, 0.03259137665072467, 0.03183339908430764, 0.03145113750726139, 0.03089447752212203, 0.031262524991129, 0.031254043191968096, 0.031128118744820115, 0.031101729281758934, 0.030398446621720497, 0.030759070209673153, 0.030879638958245324, 0.030091718287669777, 0.030208846854818547, 0.029587452951661476, 0.03011395398527759, 0.030107117451092107, 0.02981137392001199, 0.030112732891739425, 0.02963280454627536, 0.029614547387308163, 0.02792082336315464, 0.027835338230519157, 0.027791645929179716, 0.027784094268243065, 0.027787579009587855, 0.027812779833890824, 0.027831217997001084, 0.02787018309585666, 0.027873395790981113, 0.027899865770125175, 0.027910269995172644, 0.0279078931067674, 0.028127699061193237], 'valid_acc': [0.978080018184624, 0.9796428968615157, 0.9797647818908625, 0.9809170420519807, 0.9806159249021361, 0.9813227806959438, 0.9815919388121712, 0.9816222170583695, 0.9817364770730778, 0.9836117965065118, 0.9840419456861189, 0.9845892926045315, 0.9847262428195257, 0.9842488080603597, 0.9848866475417188, 0.9846988309391865, 0.9851507667346409, 0.9852470926186292, 0.9853869384305679, 0.9856137355454131, 0.9858722354920079, 0.9857945641990243, 0.9857148854182542, 0.9857856745100673, 0.9859346636336171, 0.986380379226015, 0.9860363534218031, 0.9858815748238396, 0.9863697906951451, 0.9861388066571645, 0.9866612564283327, 0.9863807420353708, 0.9861960222084307, 0.9863797653732185, 0.9862329797576762, 0.9865347425706161, 0.9864090480430326, 0.9873825025136068, 0.9874253862355777, 0.9874553781890852, 0.9874651645845783, 0.9874837099888812, 0.9874888864702362, 0.9874958873152244, 0.9874917021115646, 0.9874982421370865, 0.9874984226820266, 0.9875020499158477, 0.9875052558781418, 0.9874857639025097]}
# dir = './'

#[Small width tested on 1000 event dataset]
# data = {'epoch': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49], 'lr': [0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001], 'train_time': [33.13563370704651, 14.220604181289673, 14.20497727394104, 14.205416202545166, 14.201504468917847, 14.173409700393677, 14.208034038543701, 14.201331377029419, 14.174364805221558, 14.203420877456665, 14.191692113876343, 14.186583518981934, 14.183270931243896, 14.182790040969849, 14.164894342422485, 14.194371223449707, 14.199584722518921, 14.172295570373535, 14.19862675666809, 14.182084321975708, 14.178936958312988, 14.177219867706299, 14.201930284500122, 14.160597324371338, 14.18501877784729, 14.194885969161987, 14.202890872955322, 14.17342209815979, 14.188042402267456, 14.206180572509766, 14.178144693374634, 14.187167406082153, 14.199836254119873, 14.19999098777771, 14.168074369430542, 14.206799030303955, 14.186002969741821, 14.199837923049927, 14.159257173538208, 14.171225786209106, 14.19787311553955, 14.175692558288574, 14.19586443901062, 14.198056936264038, 14.196148157119751, 14.208720922470093, 14.178777933120728, 14.210567235946655, 14.176673889160156, 14.245543956756592], 'train_loss': [61.15047258511186, 13.450187439564615, 10.751871318439953, 2.899480320746079, 1.2228046187665313, 0.6007324032252654, 0.3840160610852763, 0.27960845475899987, 0.2202135636471212, 0.1888978706265334, 0.16560470343392808, 0.14727068298088852, 0.13672689578379504, 0.126296067101066, 0.1200345853867475, 0.11287037962756585, 0.10926962929806905, 0.10414061645133188, 0.09960488747310592, 0.09823889604740543, 0.09372721826366615, 0.09079665132594528, 0.08858887091628276, 0.08680982350779232, 0.08680500075570308, 0.08277663843182381, 0.08131438864802476, 0.07749688214244088, 0.07180776264431188, 0.07261329246102832, 0.07224342738481937, 0.06773091359355021, 0.0673896868902375, 0.06785073160426691, 0.06532962092751404, 0.0641133523240569, 0.06635280383488862, 0.06306624267017469, 0.06291578202217352, 0.06311970193928573, 0.06219733258330962, 0.060993401930318214, 0.06211396030994365, 0.06056768611597363, 0.060088671794801485, 0.060496373029309325, 0.0602833099765121, 0.05865341717435513, 0.05977126202196814, 0.058199787155899685], 'valid_time': [5.383786201477051, 1.7211918830871582, 1.7115511894226074, 1.714468002319336, 1.712679147720337, 1.7132911682128906, 1.716609239578247, 1.7123372554779053, 1.707956075668335, 1.7075996398925781, 1.7173831462860107, 1.7150895595550537, 1.7242658138275146, 1.7179770469665527, 1.707047939300537, 1.71604323387146, 1.7102525234222412, 1.7126383781433105, 1.714463472366333, 1.7183268070220947, 1.7171978950500488, 1.7124524116516113, 1.7145493030548096, 1.7125599384307861, 1.7019984722137451, 1.7134265899658203, 1.7076621055603027, 1.7112650871276855, 1.7030086517333984, 1.7082135677337646, 1.701401710510254, 1.7126705646514893, 1.7048332691192627, 1.7141499519348145, 1.7066543102264404, 1.703294277191162, 1.7049860954284668, 1.7100226879119873, 1.7081162929534912, 1.7037067413330078, 1.7045035362243652, 1.7113938331604004, 1.7120997905731201, 1.7037246227264404, 1.7150449752807617, 1.7100467681884766, 1.711587905883789, 1.7252490520477295, 1.7178714275360107, 1.7505826950073242], 'valid_loss': [25.247389274835587, 14.519277998805046, 5.621424569934606, 2.0619412094354628, 0.6855157978832722, 0.40965612679719926, 0.3019280133768916, 0.21389219351112843, 0.17618335075676442, 0.15379964681342245, 0.13487587571144105, 0.12449689581990242, 0.11611959133297205, 0.11006909515708685, 0.10390085382387042, 0.09992075557820498, 0.09643010813742876, 0.09223976144567132, 0.0911599773913622, 0.08942833337932825, 0.08641697359271347, 0.08687143689021468, 0.08433264871127903, 0.08625941188074648, 0.07950641410425305, 0.07400270840153098, 0.07386677898466587, 0.06906415577977895, 0.06930710719898343, 0.06936928061768413, 0.06693553123623133, 0.06464964542537928, 0.06481428435072303, 0.06368758059106767, 0.06244687479920685, 0.06322788042016328, 0.0627898069564253, 0.061183196818456055, 0.061517719039693476, 0.061185949202626946, 0.0601404688321054, 0.06042991313152015, 0.05984489154070616, 0.058885744167491795, 0.058328106580302116, 0.05914865755476058, 0.05761791737750173, 0.0578419922851026, 0.05717888842336834, 0.056505325715988874], 'valid_acc': [0.9718127759961921, 0.9696623943353682, 0.969741089079671, 0.9442216690234555, 0.9649182130560313, 0.9564906660737056, 0.9673977055183604, 0.9720918557019814, 0.9738141066843629, 0.9739033114331477, 0.9742683820846985, 0.9745844639550276, 0.9748253254627007, 0.9752732601165308, 0.9754528856476768, 0.9757640165241591, 0.9758099652214397, 0.975907942783883, 0.9757500321380302, 0.9753694136286094, 0.9754498455637358, 0.9748388755511238, 0.9750126814930112, 0.9746309338095552, 0.9752913269010948, 0.976750132895098, 0.9775362117427151, 0.9781164334777518, 0.9779672087860163, 0.9783699764784363, 0.9782799031342397, 0.9784062837666466, 0.978082905694859, 0.9779712911844515, 0.977584853085772, 0.9775513253028792, 0.977490523624058, 0.9776325389738761, 0.9774573432793299, 0.977517102643657, 0.9772696398108547, 0.9773672699351333, 0.9771680141476821, 0.9774409268260481, 0.9774213834292842, 0.9771943325886575, 0.9773477265383693, 0.9773913300280382, 0.9773942832524382, 0.9777190510768846]}

#[Reg width tested on 1000 event dataset]
data = {'epoch': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49], 'lr': [0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.0002, 0.0002, 0.0002, 0.0002, 0.0002, 0.0002, 0.0002, 0.0002, 4e-05, 4e-05, 4e-05, 4e-05, 4e-05, 4e-05, 8.000000000000001e-06, 8.000000000000001e-06, 8.000000000000001e-06, 8.000000000000001e-06, 8.000000000000001e-06], 'train_time': [17.609570741653442, 17.38043737411499, 17.470206260681152, 17.452223300933838, 17.463624477386475, 17.544759511947632, 17.422109365463257, 17.456771850585938, 17.40859627723694, 17.46031665802002, 17.394181728363037, 17.365973949432373, 17.418640613555908, 17.381686687469482, 17.43696641921997, 17.441531658172607, 17.454586267471313, 17.504078149795532, 17.47199249267578, 17.491273641586304, 17.51688003540039, 17.51239585876465, 17.50009274482727, 17.497458696365356, 17.509138822555542, 17.519930601119995, 17.515202045440674, 17.4831120967865, 17.489168643951416, 17.508012056350708, 17.52056097984314, 17.532493352890015, 17.53730344772339, 17.444642782211304, 17.486481428146362, 17.3889057636261, 17.42146062850952, 17.5267972946167, 17.5447678565979, 17.423789978027344, 17.519444704055786, 17.460625171661377, 17.517157316207886, 17.43742036819458, 17.504497528076172, 17.531161308288574, 17.5175678730011, 17.468113660812378, 17.476829767227173, 17.430630922317505], 'train_loss': [25.90508115157718, 3.4691148416604847, 1.5875217785942368, 0.8410792879440123, 0.3651120878639631, 0.208906614134321, 0.1409493983082939, 0.11124545783241047, 0.10030809051386314, 0.0925930739249452, 0.08690061963716289, 0.08247530421067495, 0.07836836255592061, 0.07668963765900116, 0.0738674842286855, 0.07209277866786579, 0.06955885453498922, 0.06680938402860193, 0.06468567731644725, 0.062419384714303305, 0.06094617088820087, 0.059532155810302356, 0.05864851006481331, 0.05770993290207116, 0.057117843487503706, 0.05658468124966021, 0.05622714494529646, 0.0559261791750032, 0.05576761276461184, 0.05570480605092598, 0.05558066922458238, 0.054957396278041415, 0.053869523500907235, 0.05344698129192693, 0.05319129500276176, 0.05290640784369316, 0.05288811021091533, 0.05272633424465312, 0.05270364818716189, 0.05254410369525431, 0.0525253187661292, 0.0525009407356265, 0.05249073277809657, 0.05248137743546977, 0.05246547833667137, 0.052437908459978644, 0.05243590633108397, 0.052433122389629716, 0.052430055860895663, 0.05242697116773343], 'valid_time': [2.083813190460205, 2.086878776550293, 2.1167232990264893, 2.132066011428833, 2.130387306213379, 2.1007139682769775, 2.0737416744232178, 2.0990264415740967, 2.055602788925171, 2.1175549030303955, 2.0882630348205566, 2.0844368934631348, 2.1059043407440186, 2.0901007652282715, 2.0946707725524902, 2.088031530380249, 2.0999550819396973, 2.104705810546875, 2.0843422412872314, 2.086571455001831, 2.0850956439971924, 2.0879204273223877, 2.093670606613159, 2.0921387672424316, 2.119755506515503, 2.0960049629211426, 2.111849308013916, 2.093912124633789, 2.08030366897583, 2.0934536457061768, 2.1247189044952393, 2.098849058151245, 2.068174362182617, 2.062518835067749, 2.077435255050659, 2.076038122177124, 2.0912420749664307, 2.063413619995117, 2.0757906436920166, 2.087131977081299, 2.09169602394104, 2.075061798095703, 2.081059217453003, 2.056637763977051, 2.0727105140686035, 2.09077525138855, 2.0656492710113525, 2.096600294113159, 2.0569522380828857, 2.101396083831787], 'valid_loss': [5.070169205963611, 2.368288317322731, 0.6245430527254939, 0.42771861851215365, 0.22834747955203055, 0.14500507544726132, 0.10945934839546681, 0.09550228617154062, 0.08974800361320376, 0.08174591069109738, 0.07825215510092676, 0.07273144610226154, 0.07377982130274177, 0.07108452948741614, 0.07142215962521732, 0.069049875671044, 0.06757467021234334, 0.063210672698915, 0.061754299141466615, 0.058662328077480196, 0.057668913062661885, 0.056479679374024275, 0.055514015210792425, 0.054967579105868934, 0.05472362353466451, 0.054657230526208876, 0.05460909712128341, 0.0548445635009557, 0.05521863847970963, 0.05531777199357748, 0.05508254757151008, 0.052730857161805034, 0.051795086544007066, 0.051937180059030655, 0.051861886773258446, 0.05167884496040642, 0.05166135961189866, 0.051516422117128965, 0.05152505966834724, 0.051552829379215834, 0.05155465174466371, 0.05151289761997759, 0.05149944182485342, 0.051503731217235324, 0.05149382897652686, 0.051493024034425613, 0.051494666887447235, 0.051495894929394125, 0.051495557511225344, 0.05149374818429351], 'valid_acc': [0.9718079987214275, 0.9708902408093919, 0.9706437334315425, 0.9370208393411182, 0.9706115954013085, 0.9701457676819968, 0.9733439359879925, 0.9746429204262371, 0.9756669075571275, 0.9771826934101403, 0.9773128090028177, 0.9777446746415307, 0.9776283697158998, 0.9778648013869732, 0.9776354921982761, 0.9778043471463166, 0.9776775322162038, 0.9784794195003145, 0.9781081818213403, 0.9787966305446788, 0.9787384346520928, 0.9790301958508935, 0.9792249349422036, 0.9793085806803534, 0.9793974379909736, 0.9794470347889834, 0.9794728320727119, 0.9794902039809464, 0.9793311641610585, 0.979425754201396, 0.979314921426859, 0.9786745928893306, 0.9795728074046022, 0.9795524822719677, 0.9792820885202956, 0.9796546290923873, 0.9794065582427968, 0.9796171057706005, 0.9795151326692632, 0.9794893353855347, 0.9794889010878289, 0.9795078364678046, 0.9795074890296399, 0.9794995848113932, 0.9795030591930401, 0.9795018431594636, 0.9794987162159815, 0.9794951549747933, 0.9794933309244287, 0.9794931572053464]}
dir = './regWidth/'


if __name__ == "__main__":


    fig = plt.figure(figsize = (12, 9))

    ax1 = fig.add_subplot(211)
    ax1.plot(data['epoch'], data['train_loss'], 'k--',   c='r', label='Train Loss')
    ax1.plot(data['epoch'], data['valid_loss'], 'k:',    c='b', label='Val Loss')
    ax1.set_xlabel('Epoch')
    ax1.set_ylabel('Loss')
    ax1.legend(loc="upper left")

    ax2 = fig.add_subplot(212)
    ax2.plot(data['epoch'], data['valid_acc'], 'k:',    c='g', label='Val Accuracy')
    ax2.set_xlabel('Epoch')
    ax2.set_ylabel('Accuracy')
    ax2.legend(loc="upper left")

    ax1.title.set_text('Loss Curve')
    ax2.title.set_text('Validation Accuracy')
    

    plt.show()
    plt.savefig(dir+'/trainingPlots.pdf')